<!-- sanctuai_frontend.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SanctuAI - Context-Aware Mental Health Redactor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .card h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-section {
            grid-column: 1 / -1;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .consent-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
            flex-grow: 1;
        }

        .consent-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .output-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-wrap: break-word;
        }

        .redaction-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .redaction-item:hover {
            background: #f8fafc;
            border-color: #c3dafe;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .redaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .redaction-type {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-score {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            color: #4a5568;
        }

        .risk-bar {
            width: 60px;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .risk-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .risk-low { background: #48bb78; }
        .risk-medium { background: #ed8936; }
        .risk-high { background: #f56565; }

        .redaction-details {
            font-size: 14px;
            color: #4a5568;
        }

        .redaction-original {
            font-weight: 600;
            color: #2d3748;
        }

        .redaction-context {
            color: #718096;
            font-style: italic;
            margin-top: 5px;
            font-size: 13px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: white;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .sample-texts {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
        }

        .sample-texts h3 {
            color: white;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sample-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .sample-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sample-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .consent-info {
            font-size: 13px;
            color: rgba(255,255,255,0.8);
            margin-top: 10px;
        }

        .no-redactions {
            text-align: center;
            padding: 30px;
            color: #718096;
            font-size: 15px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #2d3748;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 13px;
            font-weight: normal;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .sample-btns {
                flex-direction: column;
            }

            .sample-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span></span>
                <span>SanctuAI</span>
            </h1>
            <p>Context-Aware Mental Health Text Redactor - Protect privacy while preserving meaning</p>
        </div>

        <div class="sample-texts">
            <h3>
                <span>üìù</span>
                <span>Try Sample Texts:</span>
            </h3>
            <div class="sample-btns">
                <button class="sample-btn" onclick="loadSample(1)">
                    <span>üí¨</span>
                    <span>Therapy Session</span>
                </button>
                <button class="sample-btn" onclick="loadSample(2)">
                    <span>üìì</span>
                    <span>Personal Journal</span>
                </button>
                <button class="sample-btn" onclick="loadSample(3)">
                    <span>üÜò</span>
                    <span>Crisis Support Chat</span>
                </button>
            </div>
            <p class="consent-info">Note: These samples are synthetic and don't contain real patient data.</p>
        </div>

        <div class="card input-section">
            <h2>
                <span>üìù</span>
                <span>Input Text</span>
            </h2>
            <textarea id="inputText" placeholder="Enter mental health text to redact (therapy notes, journal entries, chat logs, etc.)..."></textarea>
            
            <div class="controls">
                <label class="consent-checkbox">
                    <input type="checkbox" id="consentGiven">
                    <span>Patient/User consent obtained for processing</span>
                </label>
                <button class="btn btn-primary" onclick="processText()">
                    <span>üîí</span>
                    <span>Redact Text</span>
                </button>
                <button class="btn btn-secondary" onclick="clearAll()">
                    <span>üóëÔ∏è</span>
                    <span>Clear All</span>
                </button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Processing text with AI redaction engine...</p>
        </div>
        <br>
        <br>
        <div class="main-content" id="results" style="display: none;">
            <div class="card">
                <h2>
                    <span>üîí</span>
                    <span>Redacted Output</span>
                </h2>
                <div class="output-text" id="redactedText"></div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-secondary" onclick="copyToClipboard()">
                        <span>üìã</span>
                        <span>Copy</span>
                    </button>
                    <br>
                    <button class="btn btn-secondary" onclick="exportData()">
                        <span>üíæ</span>
                        <span>Export</span>
                    </button>
                </div>
            </div>

            <div class="card">
                <h2>
                    <span>üìä</span>
                    <span>Redaction Details</span>
                </h2>
                <div id="redactionList"></div>
            </div>
        </div>

        <div class="stats-grid" id="stats" style="display: none;">
            <div class="stat-card">
                <div class="stat-number" id="totalRedactions">0</div>
                <div class="stat-label">Total Redactions</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="highRiskCount">0</div>
                <div class="stat-label">High Risk Items</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="symptomCount">0</div>
                <div class="stat-label">Symptoms Detected</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="privacyScore">100%</div>
                <div class="stat-label">Privacy Protection</div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced sample texts for demonstration
        const sampleTexts = {
            1: `Client: I had a panic attack after my ex-boyfriend Kevin yelled at me last night. 
Therapist: Can you tell me more about what happened?
Client: We were arguing about money, and he started throwing things. It reminded me of my mom's breakdown when I was 12. I couldn't breathe and had to go to the ER.
Therapist: That sounds terrifying. Have you had panic attacks before?
Client: Yes, but not this bad since my PTSD diagnosis after the car accident with David.`,

            2: `Journal Entry - March 15th:
Today was really hard. The depression is getting worse - I couldn't get out of bed until 3pm. 
I keep thinking about what happened with Jake last week when he said I was "too emotional." 
Mom called but I couldn't answer. I'm supposed to take my Zoloft but I keep forgetting. 
Had suicidal thoughts again but didn't act on them. Texted my therapist Dr. Miller about it.`,

            3: `User: I've been having suicidal thoughts daily since Sarah left me for her coworker Mike.
Counselor: I'm here to listen. Can you tell me more about these thoughts?
User: I found out through Facebook when I saw their vacation photos. I've been drinking a bottle of vodka every night.
Counselor: That sounds incredibly painful. Have you told anyone else?
User: Just my sister Emily. She's worried but doesn't know about the cutting. I feel so worthless.`
        };

        // Mental health patterns with risk scores (simplified for frontend)
        const patterns = {
            symptoms: {
                'panic attack': 0.9, 'anxiety': 0.7, 'depression': 0.8, 'PTSD': 0.9,
                'suicidal thoughts': 0.95, 'self-harm': 0.95, 'panic': 0.8, 'trauma': 0.85,
                'bipolar': 0.8, 'OCD': 0.7, 'eating disorder': 0.8, 'addiction': 0.8,
                'breakdown': 0.8, 'episode': 0.7, 'flashback': 0.9, 'nightmare': 0.7,
                'cutting': 0.9, 'Zoloft': 0.7, 'diagnosis': 0.6, 'ER': 0.7
            },
            relationships: {
                'boyfriend': 0.6, 'girlfriend': 0.6, 'ex-boyfriend': 0.8, 'ex-girlfriend': 0.8,
                'husband': 0.6, 'wife': 0.6, 'mother': 0.7, 'father': 0.7, 'mom': 0.7, 'dad': 0.7,
                'therapist': 0.8, 'counselor': 0.8, 'doctor': 0.8, 'friend': 0.5, 'family': 0.6,
                'sister': 0.6, 'coworker': 0.5, 'Dr.': 0.7, 'client': 0.5
            },
            emotions: {
                'scared': 0.6, 'afraid': 0.6, 'anxious': 0.7, 'depressed': 0.8, 'hopeless': 0.9,
                'overwhelmed': 0.7, 'ashamed': 0.7, 'guilty': 0.7, 'betrayed': 0.8, 'worthless': 0.9,
                'abandoned': 0.8, 'violated': 0.9, 'helpless': 0.8, 'devastated': 0.8, 'terrifying': 0.8,
                'emotional': 0.6, 'painful': 0.7
            },
            names: ['Kevin', 'David', 'Jake', 'Sarah', 'Mike', 'Emily', 'Miller'],
            medical: ['ER', 'Zoloft', 'diagnosis', 'therapy', 'treatment', 'medication']
        };

        // Common context words that increase risk
        const riskIndicators = [
            'yelled', 'throwing', 'accident', 'left me', 'found out', 'drinking',
            'vodka', 'cutting', 'suicidal', 'couldn\'t breathe', 'breakdown',
            'every night', 'vacation photos', 'too emotional', 'car accident'
        ];

        // Load a sample text into the input
        function loadSample(num) {
            document.getElementById('inputText').value = sampleTexts[num];
        }

        // Clear all inputs and results
        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('consentGiven').checked = false;
            document.getElementById('results').style.display = 'none';
            document.getElementById('stats').style.display = 'none';
            document.getElementById('redactionList').innerHTML = '';
        }

        // Process the text through the redaction engine
        function processText() {
            const inputText = document.getElementById('inputText').value.trim();
            const consentGiven = document.getElementById('consentGiven').checked;
            
            if (!inputText) {
                alert('Please enter some text to redact');
                return;
            }
            
            // Show loading state
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.getElementById('stats').style.display = 'none';
            
            // Simulate processing delay (in a real app, this would be an API call)
            setTimeout(() => {
                const result = redactText(inputText, consentGiven);
                displayResults(result);
                document.getElementById('loading').style.display = 'none';
            }, 1000);
        }

        // Main redaction function (simplified frontend version)
        function redactText(text, consentGiven) {
            const redactionEntries = [];
            let redactedText = text;
            
            // Detect and redact all sensitive information
            const detectedItems = [];
            
            // Detect symptoms
            for (const [symptom, risk] of Object.entries(patterns.symptoms)) {
                const regex = new RegExp('\\b' + symptom + '\\b', 'gi');
                let match;
                while ((match = regex.exec(text)) !== null) {
                    const contextRisk = calculateContextRisk(text, match.index, match[0].length);
                    const totalRisk = Math.min(1, risk + contextRisk);
                    
                    detectedItems.push({
                        text: match[0],
                        start: match.index,
                        end: match.index + match[0].length,
                        type: 'SYMPTOM',
                        risk: totalRisk,
                        context: getContext(text, match.index, match[0].length)
                    });
                }
            }
            
            // Detect relationships
            for (const [relation, risk] of Object.entries(patterns.relationships)) {
                const regex = new RegExp('\\b' + relation + '\\b', 'gi');
                let match;
                while ((match = regex.exec(text)) !== null) {
                    const contextRisk = calculateContextRisk(text, match.index, match[0].length);
                    const totalRisk = Math.min(1, risk + contextRisk);
                    
                    detectedItems.push({
                        text: match[0],
                        start: match.index,
                        end: match.index + match[0].length,
                        type: 'RELATION',
                        risk: totalRisk,
                        context: getContext(text, match.index, match[0].length)
                    });
                }
            }
            
            // Detect emotions
            for (const [emotion, risk] of Object.entries(patterns.emotions)) {
                const regex = new RegExp('\\b' + emotion + '\\b', 'gi');
                let match;
                while ((match = regex.exec(text)) !== null) {
                    const contextRisk = calculateContextRisk(text, match.index, match[0].length);
                    const totalRisk = Math.min(1, risk + contextRisk);
                    
                    detectedItems.push({
                        text: match[0],
                        start: match.index,
                        end: match.index + match[0].length,
                        type: 'EMOTION',
                        risk: totalRisk,
                        context: getContext(text, match.index, match[0].length)
                    });
                }
            }
            
            // Detect names
            for (const name of patterns.names) {
                const regex = new RegExp('\\b' + name + '\\b', 'gi');
                let match;
                while ((match = regex.exec(text)) !== null) {
                    const contextRisk = calculateContextRisk(text, match.index, match[0].length);
                    const totalRisk = Math.min(1, 0.6 + contextRisk); // Base name risk is 0.6
                    
                    detectedItems.push({
                        text: match[0],
                        start: match.index,
                        end: match.index + match[0].length,
                        type: 'PII',
                        risk: totalRisk,
                        context: getContext(text, match.index, match[0].length)
                    });
                }
            }
            
            // Detect medical info
            for (const term of patterns.medical) {
                const regex = new RegExp('\\b' + term + '\\b', 'gi');
                let match;
                while ((match = regex.exec(text)) !== null) {
                    const contextRisk = calculateContextRisk(text, match.index, match[0].length);
                    const totalRisk = Math.min(1, 0.7 + contextRisk); // Base medical risk is 0.7
                    
                    detectedItems.push({
                        text: match[0],
                        start: match.index,
                        end: match.index + match[0].length,
                        type: 'MEDICAL',
                        risk: totalRisk,
                        context: getContext(text, match.index, match[0].length)
                    });
                }
            }
            
            // Sort by start position (reverse for proper redaction)
            detectedItems.sort((a, b) => b.start - a.start);
            
            // Apply redactions
            for (const item of detectedItems) {
                // Skip if this overlaps with a higher risk item
                if (item.redacted) continue;
                
                // Create redaction tag based on risk
                let redactionTag;
                if (item.risk > 0.8) {
                    redactionTag = `[REDACTED_HIGH_RISK:${item.type}]`;
                } else if (item.risk > 0.5) {
                    redactionTag = `[REDACTED:${item.type}]`;
                } else {
                    redactionTag = `[ANONYMIZED:${item.type}]`;
                }
                
                // Create entry
                redactionEntries.push({
                    originalText: item.text,
                    redactedText: redactionTag,
                    startPos: item.start,
                    endPos: item.end,
                    type: item.type,
                    risk: item.risk,
                    context: item.context,
                    consentGiven: consentGiven
                });
                
                // Apply to text
                redactedText = redactedText.substring(0, item.start) + 
                               redactionTag + 
                               redactedText.substring(item.end);
            }
            
            // Generate stats
            const stats = {
                totalRedactions: redactionEntries.length,
                highRiskCount: redactionEntries.filter(e => e.risk > 0.8).length,
                symptomCount: redactionEntries.filter(e => e.type === 'SYMPTOM').length,
                privacyScore: calculatePrivacyScore(redactionEntries)
            };
            
            return {
                redactedText: redactedText,
                redactionEntries: redactionEntries,
                stats: stats
            };
        }
        
        // Calculate additional risk based on surrounding context
        function calculateContextRisk(fullText, start, length) {
            const contextWindow = 50; // characters to look before and after
            const startIdx = Math.max(0, start - contextWindow);
            const endIdx = Math.min(fullText.length, start + length + contextWindow);
            const context = fullText.substring(startIdx, endIdx).toLowerCase();
            
            let risk = 0;
            
            // Check for high-risk indicators in context
            for (const indicator of riskIndicators) {
                if (context.includes(indicator.toLowerCase())) {
                    risk += 0.15; // each indicator adds 0.15 risk
                }
            }
            
            return Math.min(risk, 0.4); // cap context risk at 0.4
        }
        
        // Get context around a match
        function getContext(fullText, start, length) {
            const contextWindow = 30; // characters to include before and after
            const startIdx = Math.max(0, start - contextWindow);
            const endIdx = Math.min(fullText.length, start + length + contextWindow);
            return fullText.substring(startIdx, endIdx);
        }
        
        // Calculate privacy protection score (0-100)
        function calculatePrivacyScore(entries) {
            if (entries.length === 0) return 100;
            
            const highRiskCount = entries.filter(e => e.risk > 0.8).length;
            const baseScore = 80; // starting score for any redaction
            const bonus = Math.min(20, highRiskCount * 2); // up to 20 bonus points for high risk items
            
            return baseScore + bonus;
        }

        // Display the results
        function displayResults(result) {
            // Show redacted text
            document.getElementById('redactedText').textContent = result.redactedText;
            
            // Show redaction details
            const redactionList = document.getElementById('redactionList');
            redactionList.innerHTML = '';
            
            if (result.redactionEntries.length === 0) {
                redactionList.innerHTML = '<div class="no-redactions">No sensitive information detected</div>';
            } else {
                result.redactionEntries.forEach(entry => {
                    const riskClass = entry.risk > 0.8 ? 'risk-high' : 
                                    entry.risk > 0.5 ? 'risk-medium' : 'risk-low';
                    const riskPercent = Math.round(entry.risk * 100);
                    
                    const item = document.createElement('div');
                    item.className = 'redaction-item';
                    item.innerHTML = `
                        <div class="redaction-header">
                            <span class="redaction-type">${entry.type}</span>
                            <div class="risk-score">
                                <span>Risk: ${riskPercent}%</span>
                                <div class="risk-bar">
                                    <div class="risk-fill ${riskClass}" style="width: ${riskPercent}%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="redaction-details">
                            <div><span class="redaction-original">Original:</span> ${entry.originalText}</div>
                            <div><span class="redaction-original">Redacted:</span> ${entry.redactedText}</div>
                            <div class="redaction-context">Context: "${entry.context}"</div>
                        </div>
                    `;
                    redactionList.appendChild(item);
                });
            }
            
            // Update stats
            document.getElementById('totalRedactions').textContent = result.stats.totalRedactions;
            document.getElementById('highRiskCount').textContent = result.stats.highRiskCount;
            document.getElementById('symptomCount').textContent = result.stats.symptomCount;
            document.getElementById('privacyScore').textContent = result.stats.privacyScore + '%';
            
            // Show results sections
            document.getElementById('results').style.display = 'grid';
            document.getElementById('stats').style.display = 'grid';
        }

        // Copy redacted text to clipboard
        function copyToClipboard() {
            const text = document.getElementById('redactedText').textContent;
            navigator.clipboard.writeText(text)
                .then(() => alert('Redacted text copied to clipboard!'))
                .catch(err => alert('Failed to copy: ' + err));
        }

        // Export data as JSON
        function exportData() {
            const redactedText = document.getElementById('redactedText').textContent;
            const entries = [];
            
            document.querySelectorAll('.redaction-item').forEach(item => {
                entries.push({
                    type: item.querySelector('.redaction-type').textContent,
                    original: item.querySelector('.redaction-details div:nth-child(1)').textContent.replace('Original: ', ''),
                    redacted: item.querySelector('.redaction-details div:nth-child(2)').textContent.replace('Redacted: ', ''),
                    context: item.querySelector('.redaction-context').textContent.replace('Context: "', '').slice(0, -1),
                    risk: item.querySelector('.risk-score span').textContent.replace('Risk: ', '')
                });
            });
            
            const data = {
                redactedText: redactedText,
                redactionEntries: entries,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sanctuai-redaction-' + new Date().toISOString().slice(0, 10) + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>